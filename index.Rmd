---
title: "Global Prevalence of Depression"
author: Bhavana Poladi
output: 
  html_document: 
    theme: united
    number_sections: yes
    highlight: pygments
---

# Introduction
It is estimated that 792 million people lived with a mental disorder in 2017 which is approximately one in ten people globally. Mental health disorders are conditions that affect a person's thinking, feeling, mood or behavior. These disorders take many forms including but not limited to depression, anxiety, bipolar disorder, eating disorders(clinical anorexia and bulimia), schizophrenia, substance use disorders and alcohol use disorder. Depression is the second most prevalent mental illness which has affected 264 million people in 2017. Available data shows that mental health disorders are common everywhere in the world and have become a public health problem. Improving awareness, recognition and treatment for these disorders is therefore important. This project aims to investigate the prevalence of depression all over the world and showcase the findings using geospatial visualizations. It is important to measure how common mental illness is, so we can understand its physical, social and financial impact - and so we can show that no one is alone. These numbers are also powerful tools for raising public awareness, stigma-busting and advocating for better health care.


# Materials and methods


### Load the required packages
```{r, message=F, warning=F}
library(raster)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(highcharter)
library(DT)
library(reactable)
library(gganimate)
knitr::opts_chunk$set(cache=TRUE)  
```

### Download and clean all required data
```{r}
setwd("~/Desktop/GEO511")
depression_data <- read.csv("share-with-depression.csv")
DepData_2017 <- depression_data %>%
  filter(Year == '2017') %>%
  select(Entity, Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.) %>%
  mutate(Entity = ifelse(Entity == "United States", "United States of America", Entity)) %>%
  mutate(Entity = ifelse(Entity == "Congo", "Republic of Congo", Entity)) %>%
  mutate(Entity = ifelse(Entity == "Democratic Republic of Congo", "Democratic Republic of the Congo", Entity)) %>%
  mutate(Entity = ifelse(Entity == "Tanzania", "United Republic of Tanzania", Entity)) %>%
  mutate(Entity = ifelse(Entity == "Cote d'Ivoire", "Ivory Coast", Entity))
```

# Results
```{r, fig.width=6, fig.height=3}
options(highcharter.theme = hc_theme_smpl(tooltip = list(valueDecimals = 2)))
data(worldgeojson, package = "highcharter")
hc <- highchart() %>%
  hc_add_series_map(
    worldgeojson, DepData_2017, value = "Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.", joinBy = c('name','Entity'),
    name = "PrevalencePercent"
  )  %>% 
  hc_colorAxis(stops = color_stops()) %>% 
  hc_title(text = "Share of population with Depression in 2017") %>% 
  hc_subtitle(text = "Percentage of Prevalence") %>%
  hc_add_theme(hc_theme_ggplot2())
hc

```

```{r}
top10_depression <- DepData_2017[order(-DepData_2017$Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.),] %>%
  rename(Region = Entity, Percentage = Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.)

datatable(top10_depression, rownames = FALSE)
```

```{r}
top10_dep_countries <- top10_depression[1:10, ]
reactable(top10_dep_countries, highlight = TRUE, bordered = TRUE, striped = TRUE)
```

```{r}
data_anim <- depression_data %>%
  filter(Entity == 'Greenland' | Entity == 'Lesotho' | Entity == 'Morocco' | Entity == 'Iran' | Entity == 'Uganda' | Entity == 'United States of America' | Entity == 'Finland' | Entity == 'North America' | Entity == 'Palestine' | Entity == 'Australia') %>%
  rename(Region = Entity, Percentage = Prevalence...Depressive.disorders...Sex..Both...Age..Age.standardized..Percent.)

p <- ggplot(data_anim,
            aes(x = Percentage, y = Percentage, colour = 'red', size = Percentage)) +
  geom_point(show.legend = FALSE, alpha = 0.7) +
  scale_color_viridis_d() +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  labs(x = "Percent", y = "Prevalence")

anime <- p + facet_wrap(~Region) +
  transition_time(Year) +
  labs(title = "Year: {frame_time}")
anime
```

# Conclusions

[~200 words]

Clear summary adequately describing the results and putting them in context. Discussion of further questions and ways to continue investigation.

# References

All sources are cited in a consistent manner
